<!DOCTYPE html>
<html lang="tr">
<head>
<style>
    html { zoom: 1 !important; }
    @media (max-width: 1200px) {
        html { zoom: 0.9 !important; }
    }
    @media (max-width: 900px) {
        html { zoom: 0.8 !important; }
    }
</style>
<meta charset="UTF-8">
<title>Dashboard</title>
<link rel="stylesheet" href="css/app.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="https://unpkg.com/vis-network@9.1.6/dist/dist/vis-network.min.css">
<script src="https://unpkg.com/vis-network@9.1.6/dist/vis-network.min.js"></script>
</head>
<body>

<div class="dashboard-shell">
    <aside class="sidebar">
        <div class="brand">
            <div class="brand-title">Servis Topoloji</div>
            <div id="usernameTag" class="brand-user"></div>
        </div>
        <nav class="nav">
            <button class="nav-item" data-target="overview"><i class="fa fa-chart-line"></i><span>Genel BakÄ±ÅŸ</span></button>
            <button class="nav-item" data-target="topologies"><i class="fa fa-diagram-project"></i><span>Topolojiler</span></button>
            <button class="nav-item" data-target="topo-upload"><i class="fa fa-plus"></i><span>Topoloji Ekle</span></button>
            <button class="nav-item" data-target="sheflikler"><i class="fa fa-sitemap"></i><span>Åžeflikler</span></button>
            <button class="nav-item" data-target="servers"><i class="fa fa-server"></i><span>Sunucular</span></button>
            <button class="nav-item" data-target="ports"><i class="fa fa-network-wired"></i><span>Portlar</span></button>
            <button class="nav-item" data-target="canvas"><i class="fa fa-pencil-ruler"></i><span>Ã‡izim AlanÄ±</span></button>
            <button class="nav-item" data-target="admin-list"><i class="fa fa-users"></i><span>Adminler</span></button>
            <button class="nav-item" data-target="access-list"><i class="fa fa-id-card"></i><span>GiriÅŸ Yetkililer</span></button>
        </nav>
        <button class="nav-item logout" onclick="logout()"><i class="fa fa-right-from-bracket"></i><span>Ã‡Ä±kÄ±ÅŸ</span></button>
    </aside>

    <main class="content">
                <!-- Topoloji DÃ¼zenleme ModalÄ± -->
                <div id="editTopologyModal" style="display:none;position:fixed;z-index:99999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.35);align-items:center;justify-content:center;">
                    <div style="background:#fff;padding:2.2rem 2.5rem;border-radius:1.2rem;max-width:95vw;min-width:340px;box-shadow:0 8px 32px #0002;position:relative;">
                        <button onclick="document.getElementById('editTopologyModal').style.display='none'" style="position:absolute;top:1rem;right:1rem;font-size:1.2rem;background:none;border:none;cursor:pointer;"><i class='fa fa-times'></i></button>
                        <h2 style="margin-bottom:1.2rem;">Topoloji Bilgilerini DÃ¼zenle</h2>
                        <form id="editTopologyForm">
                            <div class="form-row">
                                <div class="form-field">
                                    <label>Topoloji AdÄ±</label>
                                    <input type="text" id="editTopologyName" required style="color:#fff;background:#1e293b;border:1px solid #334155;">
                                </div>
                                <div class="form-field">
                                    <label>Sunucu AdÄ±</label>
                                    <input type="text" id="editServerName" required style="color:#fff;background:#1e293b;border:1px solid #334155;">
                                </div>
                                <div class="form-field">
                                    <label>IP Adresi</label>
                                    <input type="text" id="editServerIp" required style="color:#fff;background:#1e293b;border:1px solid #334155;">
                                </div>
                                <div class="form-field">
                                    <label>Dosya AdÄ±</label>
                                    <input type="text" id="editFileName" required style="color:#fff;background:#1e293b;border:1px solid #334155;">
                                </div>
                                <div class="form-field">
                                    <label>Åžeflik</label>
                                    <input type="text" id="editDept" required style="color:#fff;background:#1e293b;border:1px solid #334155;">
                                </div>
                                <div class="form-field">
                                    <label>Platform</label>
                                    <input type="text" id="editPlatform" required style="color:#fff;background:#1e293b;border:1px solid #334155;">
                                </div>
                                <div class="form-field">
                                    <label>Kritiklik</label>
                                    <input type="text" id="editCritical" required style="color:#fff;background:#1e293b;border:1px solid #334155;">
                                </div>
                                <div class="form-field">
                                    <label>Not</label>
                                    <input type="text" id="editNote" style="color:#fff;background:#1e293b;border:1px solid #334155;">
                                </div>
                            </div>
                            <div class="form-actions" style="margin-top:1.2rem;">
                                <button type="submit" class="btn primary">Kaydet</button>
                            </div>
                        </form>
                    </div>
                </div>
        <div class="topbar">
            <div>
                <p class="eyebrow">Servis Topoloji</p>
                <h1>Kontrol Paneli</h1>
            </div>
            <div class="topbar-actions">
                <span id="currentUser" class="current-user"></span>
                <button id="adminTopBtn" class="btn ghost"><i class="fa fa-user-shield"></i> Admin</button>
                <button id="themeToggle" class="btn ghost"><i class="fa fa-adjust"></i> Tema</button>
            </div>
        </div>

        <section id="overview" class="section active">
            <div class="section-header">
                <div>
                    <p class="eyebrow">Genel BakÄ±ÅŸ</p>
                    <h1>Son Durum</h1>
                </div>
            </div>
            <div class="cards-grid" id="overviewCards"></div>
        </section>

        <section id="topologies" class="section">
            <div class="section-header">
                <div>
                    <p class="eyebrow">Topolojiler</p>
                    <h1>Topoloji Listesi</h1>
                </div>
            </div>
            <div class="panel">
                <div class="panel-row wrap">
                    <div class="btn-group">
                        <button class="btn success" id="exportExcelBtn"><i class="fa fa-file-excel"></i> Excel'e Aktar</button>
                        <button class="btn warning" id="exportPdfBtn"><i class="fa fa-file-pdf"></i> PDF'ye Aktar</button>
                        <button class="btn danger" id="deleteSelectedBtn"><i class="fa fa-trash"></i> SeÃ§ili Topolojileri Sil</button>
                    </div>
                    <div class="filters">
                        <label>Åžeflik
                            <select id="filterDept">
                                <option value="">TÃ¼m Åžeflikler</option>
                            </select>
                        </label>
                        <label>Kritiklik
                            <select id="filterCrit">
                                <option value="">TÃ¼mÃ¼</option>
                                <option value="DÃ¼ÅŸÃ¼k">DÃ¼ÅŸÃ¼k</option>
                                <option value="Orta">Orta</option>
                                <option value="YÃ¼ksek">YÃ¼ksek</option>
                            </select>
                        </label>
                        <label>Ara
                            <input id="filterSearch" type="text" placeholder="Sunucu / dosya ara">
                        </label>
                        <label>Sunucu (Ad/IP)
                            <input id="filterServer" type="text" placeholder="Sunucu adÄ± veya IP">
                        </label>
                        <button class="btn ghost" id="filterReset"><i class="fa fa-rotate"></i> SÄ±fÄ±rla</button>
                    </div>
                </div>

                <div class="panel-row wrap" style="align-items:center;justify-content:space-between;margin-top:0.5rem;">
                    <div id="topologyCount" class="muted" style="font-weight:600;"></div>
                    <div style="display:flex;align-items:center;gap:0.5rem;">
                        <label style="display:flex;align-items:center;gap:0.4rem;">Sayfa boyutu
                            <select id="pageSizeSelect">
                                <option value="10">10</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                                <option value="all">Hepsi</option>
                            </select>
                        </label>
                        <button class="btn ghost" id="prevPageBtn"><i class="fa fa-chevron-left"></i></button>
                        <span id="pageInfo" class="muted"></span>
                        <button class="btn ghost" id="nextPageBtn"><i class="fa fa-chevron-right"></i></button>
                    </div>
                </div>

                <div class="table-wrap">
                    <div id="versionModal" style="display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.4);align-items:center;justify-content:center;">
                        <div style="background:#fff;padding:2rem 2.5rem;border-radius:1rem;max-width:90vw;max-height:80vh;overflow:auto;box-shadow:0 8px 32px #0002;position:relative;">
                            <button onclick="closeVersionModal()" style="position:absolute;top:1rem;right:1rem;font-size:1.2rem;background:none;border:none;cursor:pointer;"><i class='fa fa-times'></i></button>
                            <h2 style="margin-bottom:1rem;">GeÃ§miÅŸ Versiyonlar</h2>
                            <div id="versionModalContent"></div>
                        </div>
                    </div>
                    <table class="table" id="topologyTable">
                        <thead>
                            <tr>
                                <th>Topoloji AdÄ±</th>
                                <th>Sunucu TanÄ±mÄ±</th>
                                <th>Dosya AdÄ±</th>
                                <th>Åžeflik</th>
                                <th>Versiyon</th>
                                <th>Ekleme Tarihi</th>
                                <th>Ekleyen KiÅŸi</th>
                                <th>Platform</th>
                                <th>Kritiklik</th>
                                <th>Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="topo-upload" class="section">
            <div class="section-header">
                <div>
                    <p class="eyebrow">Topoloji</p>
                    <h1>Topoloji Ekle (SVG / PDF / XLSX)</h1>
                </div>
            </div>
            <div class="panel">
                <form id="uploadForm" class="form">
                    <div class="form-field">
                        <label for="topologyFiles">Dosya SeÃ§ (.svg, .pdf, .xlsx, .png)</label>
                        <input type="file" id="topologyFiles" multiple accept=".svg,.pdf,.xlsx,.xls,.png,.jpg,.jpeg">
                        <small style="color:#64748b;margin-top:0.5rem;display:block;">Dosya adÄ± formatÄ±: SunucuAdÄ±(IP.Adres.i).svg - Ã–rn: IETTMSSQLDB01(10.100.0.36).svg</small>
                    </div>
                    <div id="parsedFilesPreview" style="margin:1rem 0;padding:1rem;background:#f8fafc;border-radius:8px;display:none;">
                        <h4 style="margin:0 0 0.5rem 0;color:#0f172a;font-size:0.9rem;">Parse Edilen Dosyalar - Her Biri Ä°Ã§in AyrÄ± Ayarlar:</h4>
                        <div id="fileConfigContainer"></div>
                        <div style="margin-top:1rem;padding-top:1rem;border-top:1px solid #e2e8f0;">
                            <button type="button" id="copyFirstToAll" class="btn ghost" style="margin-bottom:1rem;display:none;">
                                <i class="fa fa-copy"></i> Ä°lk AyarlarÄ± DiÄŸerlerine Kopyala
                            </button>
                        </div>
                    </div>
                    <div class="form-field" style="display:none;">
                        <label for="serverName">Sunucu AdÄ± (Opsiyonel - dosya adÄ±ndan alÄ±nÄ±r)</label>
                        <input type="text" id="serverName" placeholder="Ã–rn: IETT_MSSQLDB02">
                    </div>
                    <div class="form-field" style="display:none;">
                        <label for="serverIp">IP Adresi (Opsiyonel - dosya adÄ±ndan alÄ±nÄ±r)</label>
                        <input type="text" id="serverIp" placeholder="Ã–rn: 10.100.0.37">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn primary">Kaydet</button>
                        <span class="message" id="uploadMessage"></span>
                    </div>
                </form>
            </div>
        </section>

        <section id="sheflikler" class="section">
            <div class="section-header" style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <p class="eyebrow">Åžeflikler</p>
                    <h1>Åžeflik DÃ¼zenle</h1>
                </div>
                <button id="addSheflikBtn" class="btn" style="background: linear-gradient(135deg, #10b981, #059669); color: white; font-size: 1rem; padding: 0.6rem 1.2rem; border: none; border-radius: 0.5rem; cursor: pointer; transition: all 0.3s;"><i class="fa fa-plus"></i> Yeni Åžeflik Ekle</button>
            </div>
            <div class="panel">
                <div class="table-wrap">
                    <table class="table" id="sheflikTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Åžeflik AdÄ±</th>
                                <th>Durum</th>
                                <th>Ekleme Tarihi</th>
                                <th>Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Åžeflik Ekleme/DÃ¼zenleme ModalÄ± -->
        <div id="sheflikModal" style="display:none;position:fixed;z-index:99999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.35);align-items:center;justify-content:center;">
            <div style="background:#fff;padding:2.2rem 2.5rem;border-radius:1.2rem;max-width:500px;min-width:340px;box-shadow:0 8px 32px #0002;position:relative;">
                <button onclick="closeSheflikModal()" style="position:absolute;top:1rem;right:1rem;font-size:1.2rem;background:none;border:none;cursor:pointer;"><i class='fa fa-times'></i></button>
                <h2 id="sheflikModalTitle" style="margin-bottom:1.2rem;">Yeni Åžeflik Ekle</h2>
                <form id="sheflikForm">
                    <div class="form-field" style="margin-bottom:1rem;">
                        <label style="display:block;font-size:0.9rem;font-weight:600;color:#0f172a;margin-bottom:0.5rem;">Åžeflik AdÄ±</label>
                        <input type="text" id="sheflikNameInput" placeholder="Åžeflik adÄ±nÄ± giriniz..." required style="width:100%;padding:0.6rem;border:1px solid #cbd5e1;border-radius:0.5rem;font-size:0.95rem;color:#0f172a;background:#ffffff;">
                    </div>
                    <div class="form-actions" style="margin-top:1.5rem;display:flex;gap:0.8rem;">
                        <button type="submit" id="sheflikSubmitBtn" class="btn primary" style="flex:1;padding:0.7rem;background:linear-gradient(135deg, #3b82f6, #1d4ed8);color:white;border:none;border-radius:0.5rem;cursor:pointer;font-weight:600;transition:all 0.3s;">Kaydet</button>
                        <button type="button" onclick="closeSheflikModal()" class="btn" style="flex:1;padding:0.7rem;background:#e2e8f0;color:#0f172a;border:none;border-radius:0.5rem;cursor:pointer;font-weight:600;transition:all 0.3s;">Ä°ptal</button>
                    </div>
                </form>
            </div>
        </div>

        <section id="servers" class="section">
            <div class="section-header">
                <div>
                    <p class="eyebrow">Sunucular</p>
                    <h1>Sunucu YÃ¶netimi</h1>
                </div>
            </div>
            <div class="panel">
                <div class="panel-row wrap">
                    <div>
                        <h3>Yeni Sunucu Ekle</h3>
                        <p class="muted">Sisteme yeni sunucu eklemek iÃ§in bilgileri giriniz.</p>
                    </div>
                    <div style="margin-left:auto;display:flex;gap:0.6rem;align-items:center;">
                        <span id="serversFilterLabel" class="muted"></span>
                        <button id="exportServersExcelBtn" class="btn ghost"><i class="fa fa-file-excel"></i></button>
                        <button id="exportServersPdfBtn" class="btn ghost"><i class="fa fa-file-pdf"></i></button>
                    </div>
                </div>
                <form class="form" style="display:grid;gap:1rem;grid-template-columns:1fr 1fr;margin-bottom:2rem;">
                    <div class="form-field">
                        <label for="serverNameInput">Sunucu AdÄ±</label>
                        <input type="text" id="serverNameInput" placeholder="Ã–rn: SQLDB-01" style="background:#ffffff;color:#0f172a;">
                    </div>
                    <div class="form-field">
                        <label for="serverIpInput">IP Adresi</label>
                        <input type="text" id="serverIpInput" placeholder="Ã–rn: 192.168.1.100" style="background:#ffffff;color:#0f172a;">
                    </div>
                    <button type="button" id="addServerBtn" class="btn primary">Sunucu Ekle</button>
                </form>
                <div class="table-wrap">
                    <table class="table" id="serversTable">
                        <thead>
                            <tr>
                                <th>Sunucu Bilgileri</th>
                                <th>Kritiklik Seviyesi</th>
                                <th>Ekleme Tarihi</th>
                                <th>Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="ports" class="section">
            <div class="section-header">
                <div>
                    <p class="eyebrow">Portlar</p>
                    <h1>Port TanÄ±mlamasÄ±</h1>
                </div>
            </div>
            <div class="panel">
                <div class="panel-row wrap">
                    <div>
                        <h3>Yeni Port Ekle</h3>
                        <p class="muted">Port adÄ±, numarasÄ±, rengi ve aÃ§Ä±klamasÄ±nÄ± girerek yeni port tanÄ±mlayabilirsiniz.</p>
                    </div>
                </div>
                <form id="addPortForm" class="form" style="display:grid;gap:1rem;grid-template-columns:1fr 1fr;margin-bottom:2rem;">
                    <div class="form-field">
                        <label for="portNameInput">Port AdÄ± *</label>
                        <input type="text" id="portNameInput" placeholder="Ã–rn: HTTP, HTTPS, SSH" style="background:#ffffff;color:#0f172a;">
                    </div>
                    <div class="form-field">
                        <label for="portNumberInput">Port NumarasÄ± *</label>
                        <input type="number" id="portNumberInput" placeholder="Ã–rn: 80, 443, 22" style="background:#ffffff;color:#0f172a;" min="1" max="65535">
                    </div>
                    <div class="form-field">
                        <label for="portColorInput">Renk *</label>
                        <input type="color" id="portColorInput" value="#3db8ff" style="background:#ffffff;color:#0f172a;height:2.5rem;cursor:pointer;">
                    </div>
                    <div class="form-field">
                        <label for="portShapeInput">Åžekil *</label>
                        <select id="portShapeInput" style="background:#ffffff;color:#0f172a;">
                            <option value="circle">Daire</option>
                            <option value="square">Kare</option>
                            <option value="triangle">ÃœÃ§gen</option>
                            <option value="diamond">Elmas</option>
                        </select>
                    </div>
                    <div class="form-field" style="grid-column: 1 / -1;">
                        <label for="portDescInput">AÃ§Ä±klama</label>
                        <input type="text" id="portDescInput" placeholder="Ã–rn: Web sunucusu iÃ§in HTTP trafiÄŸi" style="background:#ffffff;color:#0f172a;">
                    </div>
                    <button type="submit" class="btn primary">Port Ekle</button>
                </form>
                <hr style="border:none;border-top:1px solid var(--border);margin:2rem 0;">
                <div class="panel-row wrap">
                    <div>
                        <h3>PortlarÄ± YÃ¶net</h3>
                        <p class="muted">Ekli portlarÄ± gÃ¶rmek, dÃ¼zenlemek veya silmek iÃ§in aÅŸaÄŸÄ±daki tabloyu kullanÄ±n.</p>
                    </div>
                    <button type="button" id="loadDefaultPortsBtn" class="btn success"><i class="fa fa-refresh"></i> VarsayÄ±lan PortlarÄ± YÃ¼kle</button>
                </div>
                <div style="margin-bottom:1rem;">
                    <input type="text" id="portSearchInput" placeholder="Port adÄ± veya numarasÄ± ile ara..." style="width:100%;max-width:400px;padding:0.5rem;border:1px solid var(--border);border-radius:6px;background:var(--input-bg);color:var(--text);">
                </div>
                <div class="table-wrap">
                    <table class="table" id="portsTable">
                        <thead>
                            <tr>
                                <th>Port AdÄ±</th>
                                <th>Port No</th>
                                <th>Åžekil</th>
                                <th>Renk</th>
                                <th>AÃ§Ä±klama</th>
                                <th>Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="canvas" class="section">
            <!-- Only keep the correct button group at the top, remove duplicate below -->
            <div class="section-header">
                <div>
                    <p class="eyebrow">Ã‡izim AlanÄ±</p>
                    <h1>Topoloji OluÅŸturucu</h1>
                </div>
            </div>
            <div class="panel">
                <div class="panel-row wrap" style="margin-bottom:1rem;">
                    <div class="btn-group">
                        <button type="button" id="saveDrawingBtn" class="btn primary"><i class="fa fa-save"></i> Topolojiyi Kaydet</button>
                        <button type="button" id="newDrawingBtn" class="btn ghost"><i class="fa fa-plus"></i> Yeni Ã‡izim</button>
                    </div>
                    <div class="btn-group">
                        <button type="button" id="exportExcelBtn" class="btn success"><i class="fa fa-file-excel"></i> Excel'e Aktar</button>
                        <button type="button" id="exportPdfBtn" class="btn warning"><i class="fa fa-file-pdf"></i> PDF'ye Aktar</button>
                    </div>
                </div>
                
                <div style="display:grid;grid-template-columns:1fr 280px;gap:1rem;">
                    <!-- Topology Builder -->
                    <div style="border:1px solid var(--border);border-radius:0.5rem;padding:1.5rem;background:var(--card);">
                        <h3 style="margin-bottom:1.5rem;display:flex;align-items:center;gap:0.5rem;">
                            <i class="fa fa-sitemap" style="color:var(--accent);font-size:1.3em;"></i>
                            Topoloji OluÅŸturucu
                        </h3>
                        
                        <!-- Topoloji AdÄ± -->
                        <div style="margin-bottom:1.5rem;">
                            <div class="form-field">
                                <label for="topologyName">Topoloji AdÄ± *</label>
                                <input type="text" id="topologyName" placeholder="Ã–rn: Sunucu-Database BaÄŸlantÄ±sÄ±" style="background:#ffffff;color:#0f172a;width:100%;">
                            </div>
                        </div>

                        <!-- Topoloji Metadata -->
                        <div style="margin-bottom:1.5rem;padding:1rem;background:rgba(168,85,247,0.05);border-radius:0.5rem;border-left:3px solid #a855f7;">
                            <h4 style="margin-bottom:0.8rem;font-size:0.95rem;"><i class="fa fa-circle-info" style="color:#a855f7;margin-right:0.5rem;"></i>Topoloji Bilgileri</h4>
                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;margin-bottom:0.8rem;">
                                <!-- Ä°ÅŸletim Sistemi -->
                                <div class="form-field">
                                    <label for="topologyPlatform">Ä°ÅŸletim Sistemi *</label>
                                    <select id="topologyPlatform" style="background:#ffffff;color:#0f172a;">
                                        <option value="">SeÃ§in...</option>
                                        <option value="Windows">Windows</option>
                                        <option value="Linux">Linux</option>
                                    </select>
                                </div>
                                <!-- Kritiklik Seviyesi -->
                                <div class="form-field">
                                    <label for="topologyCritical">Kritiklik Seviyesi *</label>
                                    <select id="topologyCritical" style="background:#ffffff;color:#0f172a;">
                                        <option value="">SeÃ§in...</option>
                                        <option value="YÃ¼ksek">ðŸ”´ YÃ¼ksek</option>
                                        <option value="Orta">ðŸŸ¡ Orta</option>
                                        <option value="DÃ¼ÅŸÃ¼k">ðŸŸ¢ DÃ¼ÅŸÃ¼k</option>
                                    </select>
                                </div>
                            </div>
                            <!-- Åžeflik -->
                            <div class="form-field" style="margin-bottom:0.8rem;">
                                <label for="topologySheflik">Åžeflik *</label>
                                <select id="topologySheflik" style="background:#ffffff;color:#0f172a;">
                                    <option value="">Åžeflik SeÃ§in...</option>
                                </select>
                            </div>
                            <!-- Not -->
                            <div class="form-field">
                                <label for="topologyNote">Not</label>
                                <textarea id="topologyNote" placeholder="Topoloji hakkÄ±nda notlar..." style="background:#ffffff;color:#0f172a;width:100%;min-height:70px;resize:vertical;padding:0.5rem;border:1px solid #e2e8f0;border-radius:0.4rem;font-family:inherit;"></textarea>
                            </div>
                        </div>
                        
                        <!-- Kaynak (Source) -->
                        <div style="margin-bottom:1.5rem;padding:1rem;background:rgba(61,184,255,0.05);border-radius:0.5rem;border-left:3px solid var(--accent);">
                            <h4 style="margin-bottom:0.8rem;font-size:0.95rem;">ðŸ“¤ Kaynak (Source)</h4>
                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;">
                                <div class="form-field">
                                    <label for="sourceType">Kaynak TÃ¼rÃ¼ *</label>
                                    <select id="sourceType" style="background:#ffffff;color:#0f172a;">
                                        <option value="server">Sunucu IP</option>
                                        <option value="internal-vip">Internal VIP</option>
                                        <option value="wan-ip">WAN IP Adresi</option>
                                    </select>
                                </div>
                                <div class="form-field" id="sourceServerField" style="position:relative;">
                                    <label for="sourceServerSearch">Sunucu Ara *</label>
                                    <div style="position:relative;">
                                        <input type="text" id="sourceServerSearch" placeholder="ðŸ” Sunucu adÄ± veya IP ara..." autocomplete="off" style="background:#ffffff;color:#0f172a;width:100%;padding-right:2.5rem;">
                                        <i class="fa fa-chevron-down" id="sourceServerDropdownIcon" style="position:absolute;right:0.8rem;top:50%;transform:translateY(-50%);color:var(--muted);cursor:pointer;pointer-events:auto;"></i>
                                    </div>
                                    <input type="hidden" id="sourceServerId">
                                    <div id="sourceServerList" style="display:none;background:#ffffff;border:1px solid var(--border);border-radius:0.4rem;max-height:200px;overflow-y:auto;margin-top:0.5rem;box-shadow:0 2px 8px rgba(0,0,0,0.1);"></div>
                                </div>
                                <div class="form-field" id="sourceExternalField" style="display:none;">
                                    <label for="sourceIp">IP Adresi *</label>
                                    <input type="text" id="sourceIp" placeholder="192.168.1.1" style="background:#ffffff;color:#0f172a;">
                                </div>
                                <div class="form-field" id="sourceNameField" style="display:none;">
                                    <label for="sourceName">TanÄ±m</label>
                                    <input type="text" id="sourceName" placeholder="Ã–rn: DÄ±ÅŸ Firewall" style="background:#ffffff;color:#0f172a;">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Hedef (Destination) -->
                        <div style="margin-bottom:1.5rem;padding:1rem;background:rgba(76,175,80,0.05);border-radius:0.5rem;border-left:3px solid #4CAF50;">
                            <h4 style="margin-bottom:0.8rem;font-size:0.95rem;">ðŸ“¥ Hedef (Destination)</h4>
                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;">
                                <div class="form-field">
                                    <label for="destType">Hedef TÃ¼rÃ¼ *</label>
                                    <select id="destType" style="background:#ffffff;color:#0f172a;">
                                        <option value="server">Sunucu IP</option>
                                        <option value="internal-vip">Internal VIP</option>
                                        <option value="wan-ip">WAN IP Adresi</option>
                                    </select>
                                </div>
                                <div class="form-field" id="destServerField" style="position:relative;">
                                    <label for="destServerSearch">Sunucu Ara *</label>
                                    <div style="position:relative;">
                                        <input type="text" id="destServerSearch" placeholder="ðŸ” Sunucu adÄ± veya IP ara..." autocomplete="off" style="background:#ffffff;color:#0f172a;width:100%;padding-right:2.5rem;">
                                        <i class="fa fa-chevron-down" id="destServerDropdownIcon" style="position:absolute;right:0.8rem;top:50%;transform:translateY(-50%);color:var(--muted);cursor:pointer;pointer-events:auto;"></i>
                                    </div>
                                    <input type="hidden" id="destServerId">
                                    <div id="destServerList" style="display:none;background:#ffffff;border:1px solid var(--border);border-radius:0.4rem;max-height:200px;overflow-y:auto;margin-top:0.5rem;box-shadow:0 2px 8px rgba(0,0,0,0.1);"></div>
                                </div>
                                <div class="form-field" id="destExternalField" style="display:none;">
                                    <label for="destIp">IP Adresi *</label>
                                    <input type="text" id="destIp" placeholder="192.168.1.2" style="background:#ffffff;color:#0f172a;">
                                </div>
                                <div class="form-field" id="destNameField" style="display:none;">
                                    <label for="destName">TanÄ±m</label>
                                    <input type="text" id="destName" placeholder="Ã–rn: VPN Gateway" style="background:#ffffff;color:#0f172a;">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Firewall ve Port SeÃ§imi -->
                        <div style="margin-bottom:1.5rem;">
                            <h4 style="margin-bottom:0.8rem;font-size:0.95rem;">ðŸ”Œ BaÄŸlantÄ± DetaylarÄ±</h4>
                            
                            <!-- Firewall Toggle -->
                            <div style="margin-bottom:1rem;padding:0.8rem;background:rgba(255,159,67,0.1);border-radius:0.4rem;border:1px solid #ff9f43;">
                                <label style="display:flex;align-items:center;gap:0.5rem;cursor:pointer;">
                                    <input type="checkbox" id="includeFirewall" checked style="width:18px;height:18px;cursor:pointer;">
                                    <span style="font-weight:600;"><i class="fa fa-shield" style="color:#ff9f43;"></i> Firewall AracÄ±lÄ±ÄŸÄ± ile BaÄŸlan</span>
                                </label>
                            </div>
                            
                            <!-- Port SeÃ§imi (Kompakt) -->
                            <div class="form-field" style="position:relative;">
                                <label style="font-size:0.85rem;margin-bottom:0.3rem;">Portlar *</label>
                                <div style="position:relative;max-width:400px;">
                                    <input type="text" id="canvasPortSearchInput" placeholder="ðŸ” Ara..." autocomplete="off" style="background:#ffffff;color:#0f172a;width:100%;padding:0.5rem 2rem 0.5rem 0.6rem;font-size:0.85rem;">
                                    <i class="fa fa-chevron-down" id="portDropdownIcon" style="position:absolute;right:0.6rem;top:50%;transform:translateY(-50%);color:var(--muted);cursor:pointer;pointer-events:auto;font-size:0.75rem;"></i>
                                </div>
                                <div id="portDropdown" style="display:none;background:#ffffff;border:1px solid var(--border);border-radius:0.4rem;max-height:250px;overflow-y:auto;margin-top:0.5rem;box-shadow:0 2px 8px rgba(0,0,0,0.1);">
                                    <div id="portSelectContainer" style="padding:0.5rem;">
                                        <!-- Port checkboxlar buraya eklenecek -->
                                    </div>
                                </div>
                                <div id="selectedPortsTags" style="display:flex;flex-wrap:wrap;gap:0.4rem;margin-top:0.5rem;min-height:32px;">
                                    <!-- SeÃ§ilen portlar tag olarak gÃ¶sterilecek -->
                                </div>
                            </div>
                            
                            <div class="form-field" style="margin-top:1rem;">
                                <label for="connectionNote" style="font-size:0.85rem;margin-bottom:0.3rem;">Not (Ä°steÄŸe BaÄŸlÄ±)</label>
                                <input type="text" id="connectionNote" placeholder="Not..." style="background:#ffffff;color:#0f172a;padding:0.5rem;font-size:0.85rem;max-width:400px;">
                            </div>
                        </div>
                        
                        <button type="button" id="addConnectionBtn" class="btn primary" style="max-width:200px;margin-bottom:0.5rem;padding:0.5rem 1rem;font-size:0.9rem;">
                            <i class="fa fa-plus"></i> BaÄŸlantÄ± Ekle
                        </button>
                        <div id="connectionMessage" style="font-size:0.8rem;color:#3ed598;margin-bottom:1rem;min-height:20px;"></div>
                        
                        <!-- BaÄŸlantÄ±lar Listesi -->
                        <div style="border-top:1px solid var(--border);padding-top:1rem;">
                            <!-- Sekme BaÅŸlÄ±klarÄ± -->
                            <div style="display:flex;gap:0.5rem;margin-bottom:1rem;border-bottom:1px solid var(--border);">
                                <button id="listViewTab" class="topology-view-tab active" onclick="switchTopologyView('list')" style="padding:0.5rem 1rem;border:none;background:none;cursor:pointer;border-bottom:2px solid var(--accent);font-weight:600;color:var(--accent);font-size:0.9rem;">
                                    <i class="fa fa-list"></i> Liste GÃ¶rÃ¼nÃ¼mÃ¼
                                </button>
                                <button id="diagramViewTab" class="topology-view-tab" onclick="switchTopologyView('diagram')" style="padding:0.5rem 1rem;border:none;background:none;cursor:pointer;border-bottom:2px solid transparent;font-weight:600;color:var(--muted);font-size:0.9rem;">
                                    <i class="fa fa-project-diagram"></i> GÃ¶rsel Diyagram
                                </button>
                            </div>
                            
                            <!-- Liste GÃ¶rÃ¼nÃ¼mÃ¼ -->
                            <div id="listView" style="display:block;">
                                <h4 style="margin-bottom:0.8rem;font-size:0.95rem;">OluÅŸturulan BaÄŸlantÄ±lar</h4>
                                <div id="topologyConnectionsList" style="display:flex;flex-direction:column;gap:0.8rem;max-height:400px;overflow-y:auto;">
                                    <p style="color:var(--muted);font-size:0.9rem;text-align:center;padding:1rem;">HenÃ¼z baÄŸlantÄ± yok</p>
                                </div>
                            </div>
                            
                            <!-- GÃ¶rsel Diyagram -->
                            <div id="diagramView" style="display:none;">
                                <div id="topologyNetwork" style="width:100%;height:500px;border:1px solid var(--border);border-radius:0.5rem;background:#fafafa;"></div>
                                <div style="margin-top:0.5rem;padding:0.5rem;background:rgba(61,184,255,0.05);border-radius:0.3rem;font-size:0.75rem;color:var(--muted);">
                                    <strong>ðŸ’¡ Ä°pucu:</strong> DÃ¼ÄŸÃ¼mleri sÃ¼rÃ¼kleyebilir, yakÄ±nlaÅŸtÄ±rabilir ve dÃ¶ndÃ¼rebilirsiniz
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- SaÄŸ Panel - KÃ¼tÃ¼phaneler -->
                    <div style="display:flex;flex-direction:column;gap:0.8rem;max-height:600px;overflow-y:auto;">
                        <!-- Sunucu KÃ¼tÃ¼phanesi -->
                        <div style="border:1px solid var(--border);border-radius:0.5rem;padding:1rem;background:var(--card);">
                            <h4 style="margin-bottom:0.5rem;display:flex;align-items:center;gap:0.5rem;font-size:0.95rem;">
                                <i class="fa fa-server" style="color:#667eea;font-size:1.2em;"></i>
                                Sunucular
                            </h4>
                            <p style="font-size:0.75rem;color:var(--muted);margin-bottom:0.8rem;">TanÄ±mlanan sunucular</p>
                            <div id="serverLibraryList" style="display:flex;flex-direction:column;gap:0.4rem;"></div>
                        </div>
                        
                        <!-- Port KÃ¼tÃ¼phanesi -->
                        <div id="portReferencePanel" style="border:1px solid var(--border);border-radius:0.5rem;padding:1rem;background:var(--card);flex:1;overflow-y:auto;min-height:200px;">
                            <h4 style="margin-bottom:0.5rem;display:flex;align-items:center;gap:0.5rem;font-size:0.95rem;">
                                <i class="fa fa-plug" style="color:var(--accent);font-size:1.2em;"></i>
                                Portlar
                            </h4>
                            <p style="font-size:0.75rem;color:var(--muted);margin-bottom:0.8rem;">TanÄ±mlanan portlar</p>
                            <div id="portReferenceList" style="display:flex;flex-direction:column;gap:0.4rem;"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Kaydetme Formu (gizli) -->
                <div id="saveDrawingForm" style="display:none;margin-top:1rem;padding:1.5rem;background:var(--card);border-radius:0.5rem;border:1px solid var(--border);">
                    <h3 style="margin-bottom:1rem;">Topoloji Bilgileri</h3>
                    <form id="topologySaveForm" class="form" style="display:grid;gap:1rem;grid-template-columns:1fr 1fr;">
                        <div class="form-field">
                            <label for="drawingTopologyName">Topoloji AdÄ± *</label>
                            <input type="text" id="drawingTopologyName" required placeholder="Ã–rn: Web KatmanÄ± Topolojisi">
                        </div>
                        <div class="form-field">
                            <label for="drawingServerName">Sunucu AdÄ± *</label>
                            <input type="text" id="drawingServerName" required placeholder="Ã–rn: WebServer-01">
                        </div>
                        <div class="form-field">
                            <label for="drawingServerIp">IP Adresi *</label>
                            <input type="text" id="drawingServerIp" required placeholder="Ã–rn: 192.168.1.100">
                        </div>
                        <div class="form-field">
                            <label for="drawingDept">Åžeflik *</label>
                            <select id="drawingDept" required></select>
                        </div>
                        <div class="form-field">
                            <label for="drawingPlatform">Ä°ÅŸletim Sistemi *</label>
                            <select id="drawingPlatform" required></select>
                        </div>
                        <div class="form-field">
                            <label for="drawingCritical">Kritiklik Seviyesi *</label>
                            <select id="drawingCritical" required></select>
                        </div>
                        <div class="form-field" style="grid-column:1/-1;">
                            <label for="drawingNote">Not (AÃ§Ä±klama)</label>
                            <textarea id="drawingNote" rows="2" placeholder="Varsa not yazÄ±nÄ±z..."></textarea>
                        </div>
                        <div class="form-actions" style="grid-column:1/-1;display:flex;gap:0.5rem;">
                            <button type="submit" class="btn primary">Kaydet</button>
                            <button type="button" id="cancelSaveBtn" class="btn ghost">Ä°ptal</button>
                            <span class="message" id="saveDrawingMessage"></span>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <section id="admin" class="section">
            <div class="section-header">
                <div>
                    <p class="eyebrow">Admin</p>
                    <h1>KullanÄ±cÄ± ve Åžifre</h1>
                </div>
            </div>
            <div class="panel">
                <div class="panel-row">
                    <div>
                        <h3>Åžifre DeÄŸiÅŸtirme</h3>
                        <p class="muted">Ä°steÄŸe baÄŸlÄ± olarak ÅŸifrenizi burada gÃ¼ncelleyebilirsiniz.</p>
                    </div>
                    <button class="btn ghost" id="toggleChange">Åžifre DeÄŸiÅŸtir</button>
                </div>
                <form id="changePasswordForm" class="form" style="display:none">
                    <div class="form-field">
                        <label for="oldPassword">Eski Åžifre</label>
                        <input type="password" id="oldPassword" required>
                    </div>
                    <div class="form-field">
                        <label for="newPassword">Yeni Åžifre</label>
                        <input type="password" id="newPassword" required>
                    </div>
                    <div class="form-field">
                        <label for="confirmPassword">Yeni Åžifre (Tekrar)</label>
                        <input type="password" id="confirmPassword" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn primary">Kaydet</button>
                        <div id="changePasswordMessage" class="message"></div>
                    </div>
                </form>
            </div>
        </section>

        <section id="admin-list" class="section">
            <div class="section-header">
                <div>
                    <p class="eyebrow">Adminler</p>
                    <h1>Admin Listesi</h1>
                </div>
            </div>
            <div class="panel">
                <p class="muted">Ã–rnek alan: admin kullanÄ±cÄ±larÄ±nÄ± burada listeleyip yÃ¶netebilirsiniz.</p>
            </div>
        </section>

        <section id="access-list" class="section">
            <div class="section-header">
                <div>
                    <p class="eyebrow">GiriÅŸ Yetkililer</p>
                    <h1>Yetkili Listesi</h1>
                </div>
            </div>
            <div class="panel">
                <p class="muted">Ã–rnek alan: giriÅŸ yetkili kullanÄ±cÄ±larÄ±nÄ± burada yÃ¶netebilirsiniz.</p>
            </div>
        </section>
    </main>
</div>

<div class="fab-stack">
    <button class="fab danger" id="fabLogout"><i class="fa fa-right-from-bracket"></i></button>
</div>

<script src="js/app.js?v=20260131-7"></script>
</body>
</html>
